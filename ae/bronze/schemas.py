"""APC CSV schemas"""

import pyspark.sql.types as T

ALL_COLUMNS = {
    "activage": T.IntegerType(),
    "aearrivalmode": T.StringType(),
    "aeattend_exc_planned": T.StringType(),
    "aeattendcat": T.StringType(),
    "aeattenddisp": T.StringType(),
    "aedepttype": T.StringType(),
    "aeincloctype": T.StringType(),
    "aekey": T.StringType(),
    "aekey_flag": T.IntegerType(),
    "aepatgroup": T.StringType(),
    "aerefsource": T.StringType(),
    "appdate": T.DateType(),
    "arrivalage": T.IntegerType(),
    "arrivalage_calc": T.FloatType(),
    "arrivaldate": T.DateType(),
    "arrivaltime": T.IntegerType(),
    "at_gp_practice": T.StringType(),
    "at_residence": T.StringType(),
    "at_treatment": T.StringType(),
    "cannet": T.StringType(),
    "canreg": T.StringType(),
    "carersi": T.StringType(),
    "ccg_gp_practice": T.StringType(),
    "ccg_residence": T.StringType(),
    "ccg_responsibility": T.StringType(),
    "ccg_responsibility_origin": T.StringType(),
    "ccg_treatment": T.StringType(),
    "ccg_treatment_origin": T.StringType(),
    "cdsextdate": T.DateType(),
    "cdsuniqueid": T.StringType(),
    "cdsverprotid": T.StringType(),
    "concldur": T.IntegerType(),
    "concltime": T.IntegerType(),
    "cr_gp_practice": T.StringType(),
    "cr_residence": T.StringType(),
    "cr_treatment": T.StringType(),
    "csnum": T.StringType(),
    "currward": T.StringType(),
    "currward_ons": T.StringType(),
    "depdur": T.IntegerType(),
    "deptime": T.IntegerType(),
    "diag2_01": T.StringType(),
    "diag2_02": T.StringType(),
    "diag2_03": T.StringType(),
    "diag2_04": T.StringType(),
    "diag2_05": T.StringType(),
    "diag2_06": T.StringType(),
    "diag2_07": T.StringType(),
    "diag2_08": T.StringType(),
    "diag2_09": T.StringType(),
    "diag2_10": T.StringType(),
    "diag2_11": T.StringType(),
    "diag2_12": T.StringType(),
    "diag3_01": T.StringType(),
    "diag3_02": T.StringType(),
    "diag3_03": T.StringType(),
    "diag3_04": T.StringType(),
    "diag3_05": T.StringType(),
    "diag3_06": T.StringType(),
    "diag3_07": T.StringType(),
    "diag3_08": T.StringType(),
    "diag3_09": T.StringType(),
    "diag3_10": T.StringType(),
    "diag3_11": T.StringType(),
    "diag3_12": T.StringType(),
    "diag_01": T.StringType(),
    "diag_02": T.StringType(),
    "diag_03": T.StringType(),
    "diag_04": T.StringType(),
    "diag_05": T.StringType(),
    "diag_06": T.StringType(),
    "diag_07": T.StringType(),
    "diag_08": T.StringType(),
    "diag_09": T.StringType(),
    "diag_10": T.StringType(),
    "diag_11": T.StringType(),
    "diag_12": T.StringType(),
    "diaga_01": T.StringType(),
    "diaga_02": T.StringType(),
    "diaga_03": T.StringType(),
    "diaga_04": T.StringType(),
    "diaga_05": T.StringType(),
    "diaga_06": T.StringType(),
    "diaga_07": T.StringType(),
    "diaga_08": T.StringType(),
    "diaga_09": T.StringType(),
    "diaga_10": T.StringType(),
    "diaga_11": T.StringType(),
    "diaga_12": T.StringType(),
    "diags_01": T.StringType(),
    "diags_02": T.StringType(),
    "diags_03": T.StringType(),
    "diags_04": T.StringType(),
    "diags_05": T.StringType(),
    "diags_06": T.StringType(),
    "diags_07": T.StringType(),
    "diags_08": T.StringType(),
    "diags_09": T.StringType(),
    "diags_10": T.StringType(),
    "diags_11": T.StringType(),
    "diags_12": T.StringType(),
    "diagscheme": T.StringType(),
    "domproc": T.StringType(),
    "encrypted_hesid": T.StringType(),
    "epikey": T.StringType(),
    "ethnos": T.StringType(),
    "fyear": T.StringType(),
    "gortreat": T.StringType(),
    "gpprac": T.StringType(),
    "gpprpct": T.StringType(),
    "gpprstha": T.StringType(),
    "hatreat": T.StringType(),
    "hrgnhs": T.StringType(),
    "hrgnhsvn": T.StringType(),
    "imd04": T.FloatType(),
    "imd04_decile": T.StringType(),
    "imd04c": T.FloatType(),
    "imd04ed": T.FloatType(),
    "imd04em": T.FloatType(),
    "imd04hd": T.FloatType(),
    "imd04hs": T.FloatType(),
    "imd04i": T.FloatType(),
    "imd04ia": T.FloatType(),
    "imd04ic": T.FloatType(),
    "imd04le": T.FloatType(),
    "imd04rk": T.FloatType(),
    "initdur": T.IntegerType(),
    "inittime": T.IntegerType(),
    "invest2_01": T.StringType(),
    "invest2_02": T.StringType(),
    "invest2_03": T.StringType(),
    "invest2_04": T.StringType(),
    "invest2_05": T.StringType(),
    "invest2_06": T.StringType(),
    "invest2_07": T.StringType(),
    "invest2_08": T.StringType(),
    "invest2_09": T.StringType(),
    "invest2_10": T.StringType(),
    "invest2_11": T.StringType(),
    "invest2_12": T.StringType(),
    "invest_01": T.StringType(),
    "invest_02": T.StringType(),
    "invest_03": T.StringType(),
    "invest_04": T.StringType(),
    "invest_05": T.StringType(),
    "invest_06": T.StringType(),
    "invest_07": T.StringType(),
    "invest_08": T.StringType(),
    "invest_09": T.StringType(),
    "invest_10": T.StringType(),
    "invest_11": T.StringType(),
    "invest_12": T.StringType(),
    "lsoa01": T.StringType(),
    "lsoa11": T.StringType(),
    "msoa01": T.StringType(),
    "msoa11": T.StringType(),
    "mydob": T.StringType(),
    "newnhsno_check": T.StringType(),
    "nhsnoind": T.StringType(),
    "nodiags": T.IntegerType(),
    "noinvests": T.IntegerType(),
    "notreats": T.IntegerType(),
    "oacode6": T.StringType(),
    "orgpppid": T.StringType(),
    "partyear": T.StringType(),
    "pcfound": T.StringType(),
    "pcon": T.StringType(),
    "pcon_ons": T.StringType(),
    "pctcode02": T.StringType(),
    "pctcode06": T.StringType(),
    "pctcode_his": T.StringType(),
    "pctorig02": T.StringType(),
    "pctorig_his": T.StringType(),
    "pcttreat": T.StringType(),
    "perend": T.StringType(),
    "person_id_deid": T.StringType(),
    "pgpprac": T.StringType(),
    "postdist": T.StringType(),
    "preggmp": T.StringType(),
    "procode": T.StringType(),
    "procode3": T.StringType(),
    "procode5": T.StringType(),
    "procodet": T.StringType(),
    "protype": T.StringType(),
    "purcode": T.StringType(),
    "purstha": T.StringType(),
    "purval": T.StringType(),
    "rescty": T.StringType(),
    "rescty_ons": T.StringType(),
    "resgor": T.StringType(),
    "resgor_ons": T.StringType(),
    "resha": T.StringType(),
    "resladst": T.StringType(),
    "resladst_ons": T.StringType(),
    "respct02": T.StringType(),
    "respct06": T.StringType(),
    "respct_his": T.StringType(),
    "resro": T.StringType(),
    "resstha02": T.StringType(),
    "resstha06": T.StringType(),
    "resstha_his": T.StringType(),
    "rotreat": T.StringType(),
    "rttperend": T.StringType(),
    "rttperstart": T.StringType(),
    "rttperstat": T.StringType(),
    "rururb_ind": T.StringType(),
    "sex": T.StringType(),
    "soal": T.StringType(),
    "soam": T.StringType(),
    "sthatret": T.StringType(),
    "subdate": T.DateType(),
    "sushrg": T.StringType(),
    "sushrginfo": T.StringType(),
    "sushrgverinfo": T.StringType(),
    "sushrgvers": T.StringType(),
    "suslddate": T.DateType(),
    "susrecid": T.StringType(),
    "susspellid": T.StringType(),
    "treat2_01": T.StringType(),
    "treat2_02": T.StringType(),
    "treat2_03": T.StringType(),
    "treat2_04": T.StringType(),
    "treat2_05": T.StringType(),
    "treat2_06": T.StringType(),
    "treat2_07": T.StringType(),
    "treat2_08": T.StringType(),
    "treat2_09": T.StringType(),
    "treat2_10": T.StringType(),
    "treat2_11": T.StringType(),
    "treat2_12": T.StringType(),
    "treat3_01": T.StringType(),
    "treat3_02": T.StringType(),
    "treat3_03": T.StringType(),
    "treat3_04": T.StringType(),
    "treat3_05": T.StringType(),
    "treat3_06": T.StringType(),
    "treat3_07": T.StringType(),
    "treat3_08": T.StringType(),
    "treat3_09": T.StringType(),
    "treat3_10": T.StringType(),
    "treat3_11": T.StringType(),
    "treat3_12": T.StringType(),
    "treat_01": T.StringType(),
    "treat_02": T.StringType(),
    "treat_03": T.StringType(),
    "treat_04": T.StringType(),
    "treat_05": T.StringType(),
    "treat_06": T.StringType(),
    "treat_07": T.StringType(),
    "treat_08": T.StringType(),
    "treat_09": T.StringType(),
    "treat_10": T.StringType(),
    "treat_11": T.StringType(),
    "treat_12": T.StringType(),
    "tretdur": T.StringType(),
    "trettime": T.StringType(),
    "waitdays": T.IntegerType(),
    "ward91": T.StringType(),
}


def create_schema(file: str, sep: str) -> T.StructType:
    """create csv schema"""
    with open(file, "r", encoding="UTF-8") as f:
        cols = f.read().lower().split(sep)

    return T.StructType([T.StructField(c, ALL_COLUMNS[c], True) for c in cols])
